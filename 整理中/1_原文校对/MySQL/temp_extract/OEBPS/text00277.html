<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" style="font-size:1.250rem;">
<head><title></title>
<link href="flow0001.css" rel="stylesheet" type="text/css" />
</head>
<body>
<h2 class="p2">18.6　MHA方案实战</h2>
<h3 class="p3">
<a id="b1">18.6.1　搭建MHA的先决必要条件</a>
</h3>
<p class="ziti6">·两台以上MySQL服务器或虚拟机环境（最好不用多实例环境）。</p>
<p class="ziti6">·在多台MySQL之间实现主从复制。</p>
<p class="ziti">检验方法，登录到所有从库，执行如下命令：</p>
<hr/>
<pre class="ziti1">mysql&gt; show slave status\G                   #&lt;==查看复制状态命令。
 Slave_IO_Running: Yes                       #&lt;==有两个Yes，证明主从复制成功。
 Slave_SQL_Running: Yes                      #&lt;==有两个Yes，证明主从复制成功。</pre>
<hr/>
<p class="ziti6">·MySQL配置文件参数的更改</p>
<p class="ziti">用于提升主库的从库my.cnf的额外设置（也可以使全部数据库均按此参数进行设置）：</p>
<hr/>
<pre class="ziti1">relay_log_purge = 0              #&lt;==不自动删除relay log，以便于宕机后修复数据。
log_bin = /application/mysql/logs/oldboy-bin  #&lt;==从库开启binlog，以便于宕机
                                            后修复数据。
expire_logs_days = 7             #&lt;==自动删除7天前的binlog。
log-slave-updates = 1            #&lt;==从库开启Binlog，以便于宕机后修复数据。</pre>
<hr/>
</body>
</html>
