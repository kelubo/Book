<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>未知</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link rel="stylesheet" type="text/css" href="../../stylesheet.css"/>
<link rel="stylesheet" type="text/css" href="../../page_styles.css"/>
</head>
  <body class="calibre"> 
 <h3 class="p" id="sigil_toc_id_10">1.2.2　工作流机制</h3> 
 <p class="ziti3">Nginx在处理客户端请求时，每个连接仅由一个进程进行处理，每个请求仅运行在一个工作流中，工作流被划分为多个阶段（见图1-4），请求在不同阶段由功能模块进行数据处理，处理结果异常或结束则将结果返回客户端，否则将进入下一阶段。工作进程维护工作流的执行，并通过工作流的状态推动工作流完成请求操作的闭环。</p> 
 <p class="ziti3">图1-4所示为HTTP请求阶段的工作流。</p> 
 <p class="ziti3">HTTP消息头包括请求头和响应头。</p> 
 <div class="pic"> 
  <a href="http://popImage?src='../Images/1-3.jpg'" class="pcalibre calibre1"><img alt="" src="../Images/1-3.jpg" class="calibre7"/></a> 
 </div> 
 <p class="middle-img">图1-3　异步非阻塞机制</p> 
 <div class="pic"> 
  <a href="http://popImage?src='../Images/1-4.jpg'" class="pcalibre calibre1"><img alt="" src="../Images/1-4.jpg" class="calibre8"/></a> 
 </div> 
 <p class="middle-img">图1-4　Nginx工作流</p> 
 <p class="ziti3"><span class="yanse">1.HTTP请求处理阶段</span></p> 
 <p class="ziti3">HTTP请求的处理过程可分为11个阶段，HTTP请求处理阶段如表1-2所示。</p> 
 <p class="middle-img">表1-2　HTTP请求处理阶段</p> 
 <div class="pic"> 
  <a href="http://popImage?src='../Images/b1-2.jpg'" class="pcalibre calibre1"><img alt="" src="../Images/b1-2.jpg" class="calibre9"/></a> 
 </div> 
 <p class="ziti3">HTTP请求处理阶段可以让每个模块仅在该阶段独立完成该阶段可实现的功能，而整个HTTP请求则是由多个功能模块共同处理完成的。</p> 
 <p class="ziti3"><span class="yanse">2.TCP/UDP处理阶段</span></p> 
 <p class="ziti3">TCP/UDP会话一共会经历7个处理阶段，每个TCP/UDP会话会自上而下地按照7个阶段进行流转处理，每个处理阶段的说明如表1-3所示。</p> 
 <p class="middle-img">表1-3　TCP/UDP处理阶段</p> 
 <div class="pic"> 
  <a href="http://popImage?src='../Images/b1-3.jpg'" class="pcalibre calibre1"><img alt="" src="../Images/b1-3.jpg" class="calibre10"/></a> 
 </div> 
 <div class="pic"> 
  <a href="http://popImage?src='../Images/012-i.jpg'" class="pcalibre calibre1"><img alt="" src="../Images/012-i.jpg" class="calibre11"/></a> 
 </div> 
 <p class="ziti3">Nginx功能模块就是根据不同的功能目的，按照模块开发的加载约定嵌入不同的处理阶段的。</p> 
</body>
</html>
