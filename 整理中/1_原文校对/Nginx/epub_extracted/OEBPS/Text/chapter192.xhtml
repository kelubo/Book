<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>未知</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link rel="stylesheet" type="text/css" href="../../stylesheet.css"/>
<link rel="stylesheet" type="text/css" href="../../page_styles.css"/>
</head>
  <body class="calibre">
  <h1 class="p2" id="sigil_toc_id_206">第11章　Nginx集群负载与配置管理</h1>

  <p class="ziti3">高业务量的互联网应用服务器通常需要应对每秒几万个到几十万个请求的处理。为实现高并发的处理能力，网站架构师们会使用负载均衡设备对同一个应用的服务器集群进行负载。负载均衡设备由硬件或软件设备构成，负责把客户端的请求按照不同的策略转发给后端的应用服务器，每组应用服务器集群均可根据实际的处理性能进行横向扩展，以提高请求的处理能力。在同一企业内部，许多应用集群会共享一个或一组负载均衡设备，由于负载均衡设备会负责所有应用的负载，所以它会被实施更加严格的管理策略。互联网业务产品的复杂性及解耦需求，使得应用开发团队希望可以更加灵活地进行负载均衡负载及路由策略变更，因此会在负载均衡设备及应用服务器之间再部署一组负载均衡实现应用层的二次负载转发。这种方式既可以有效解决多个团队共用负载均衡设备的使用冲突，又可以通过二次负载均衡的横向扩展，不断提高应用服务器整体的负载能力。在实际使用中，入口的负载均衡设备仅负责在传输层（网络分层模型的第四层）实现数据包的快速转发，被转发的数据包继续由多组Nginx负载集群进行应用层（OSI七层模型的第七层）负载、路由及管控，以此实现对客户请求多层负载均衡设备转发的负载架构。</p>

  <p class="ziti3">业务应用请求经Nginx集群的二次负载，可以避免多个应用团队因共享负载均衡设备产生的使用冲突，从而有效降低因部分应用负载策略频繁变更带来的影响，但同样给Nginx的配置管理带来了挑战。为了给应用团队提供更灵活的策略变更能力，需要有一套可Web化、规范化的操作平台对多组Nginx集群进行配置管理。本章将推荐一个无须编写代码，通过对现有的开源软件Jenkins、GitLab和Ansible进行组合，快速搭建一套Web化的Nginx集群配置管理框架的方法。该管理框架通过Jenkins的Web化管理界面实现了权限管理、前端配置、发布记录等功能。它结合GitLab的版本控制功能对每次的变更进行归档，并可随时实现配置回滚。通过对Ansible剧本的调用，自动化地实现了Nginx集群的配置修改、加载、灰度发布等操作。</p>

  <p class="ziti3">本章内容如下。</p>

  <p class="ziti4">·多层负载均衡架构。</p>

  <p class="ziti4">·基于LVS与Keepalived的高可用Nginx集群负载的搭建。</p>

  <p class="ziti4">·基于Jenkins的Web化Nginx集群配置管理框架的搭建。</p>
</body>
</html>
