<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>c05</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="../stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="../page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body id="8IL20-4cbd95e5336c4fe1b8728c179770ce3b" class="calibre">
<div id="c05" class="calibre1">
<p class="experiment-number1" id="t5"><span class="charoverride12">Experiment #161 — Transistor Subleties</span></p>
<p class="body-text18"><span class="charoverride5">Last month’s column touched on the effects of some transistor characteristics that can be ignored for simple and low-frequency applications, but which become significant in more demanding circuits. This month we’re going to tackle two of these effects in different circuits you can build and test: dynamic emitter resistance (introduced last month) and the Miller effect.</span></p>
<p class="subhead2"><span class="charoverride12">Accounting for r</span><span class="charoverride33">e</span></p>
<p class="body-text18"><span class="charoverride5">I received a nice note from Loren Moline, WA7SKT, who was breadboarding a common-emitter amplifier (see Figure 1) and discovered that the measured gain was less than calculated. In the original “Hands-On Radio” Experiment #1, the equation for voltage gain was given as:<a id="_idTextAnchor000" class="calibre7"></a></span></p>
<p class="figure"><img src="../images/00134.jpeg" alt="" class="calibre5"/></p>
<table class="calibre25">
<tr class="calibre9"><td class="calibre10"><p class="body-text18"><span class="charoverride5"><img src="../images/00135.jpeg" alt="" class="calibre26"/></span></p></td><td class="calibre27"><p class="body-text18"><span class="charoverride5"> 			[Eq 1]</span></p></td></tr>
</table>
<p class="body-text18"><span class="charoverride5"> This is close enough in many cases. (The minus sign indicated an inverting amplifier.) However, what Loren found is that with R</span><span class="charoverride15">C</span><span class="charoverride5"> = 4.7 kΩ and R</span><span class="charoverride15">E</span><span class="charoverride5"> = 100 Ω, the measured magnitude of gain was only 37 when the calculated gain was 47. Good for Loren not just throwing up his hands and thinking, “I guess that’s okay.” He dug a little deeper and discovered that the dynamic emitter resistance, </span><span class="charoverride13">r</span><span class="charoverride20">e</span><span class="charoverride5">, introduced last month, has to be taken into account as well:</span></p>
<table class="calibre25">
<tr class="calibre9"><td class="calibre10"><span class="charoverride34"><img src="../images/00136.jpeg" alt="" class="calibre28"/></span></td><td class="calibre27"><p class="body-text18"><span class="calibre7">[Eq 2]</span></p></td></tr>
</table>
<p class="body-text18"><span class="charoverride5">When this equation is used for the 1 mA of quiescent current in Loren’s circuit, the calculated gain worked out to a magnitude 37.3, almost the same as the measured value.</span></p>
<p class="body-text18"><span class="charoverride5">Taking the process of accountability one step further, it’s also important to take into account the load resistance, </span><span class="charoverride13">R</span><span class="charoverride20">L</span><span class="charoverride13"> </span><span class="charoverride5">in Figure 2. From the ac signal’s standpoint, </span><span class="charoverride13">R</span><span class="charoverride20">L</span><span class="charoverride5"> is in parallel with </span><span class="charoverride13">R</span><span class="charoverride20">C</span><span class="charoverride5"> and so the true equation for gain becomes:</span></p>
<p class="figure"><img src="../images/00137.jpeg" alt="" class="calibre5"/></p>
<table class="calibre25">
<tr class="calibre9"><td class="calibre10"><p class="body-text18"><span class="charoverride5"><img src="../images/00138.jpeg" alt="" class="calibre29"/></span></p></td><td class="calibre27"><p class="body-text18"><span class="charoverride5">			[Eq 3]</span></p></td></tr>
</table>
<p class="body-text18"><span class="charoverride5">How about a little workbench check of all this? Start with the circuit of Figure 1 using Loren’s values for R</span><span class="charoverride15">C</span><span class="charoverride5"> and R</span><span class="charoverride15">E</span><span class="charoverride5"> along with  39 kΩ for R1 and 6.8 kΩ</span><span class="charoverride5"> for R2. The values are derived in Experiment #1 to set I</span><span class="charoverride15">CQ</span><span class="charoverride5"> ≈ 4 mA. With all of those values in hand, what is the expected magnitude of A</span><span class="charoverride15">V</span><span class="charoverride5">? (4700 / (100 + 6.5) = 44.1) </span></p>
<p class="body-text18"><span class="charoverride5">Go ahead and build the circuit using an inexpensive 2N3904 or 2N4401 and a  10 </span><span class="charoverride5" xml:lang="ar-SA">μ</span><span class="charoverride5">F electrolytic or tantalum capacitor  for C</span><span class="charoverride15">IN</span><span class="charoverride5">. Verify that you got the right  gain at 10 kHz. You might even want to measure R</span><span class="charoverride15">C</span><span class="charoverride5"> and R</span><span class="charoverride15">E</span><span class="charoverride5"> and use the exact values to calculate gain. (If you lower the frequency of operation, what causes the gain to drop below about 200 Hz? The reactance of C</span><span class="charoverride15">IN</span><span class="charoverride5"> begins to become significant — 100 Ω at 160 Hz.)</span></p>
<p class="body-text18"><span class="charoverride5">Next, add the emitter bypass capacitor, C</span><span class="charoverride15">E</span><span class="charoverride5">, of Figure 2 — a 100 μF component will  do nicely. At 10 kHz, a 100 μF capacitor’s reactance is how much? (X</span><span class="charoverride15">C </span><span class="charoverride5">= 0.16 Ω) In parallel with the 100 Ω R</span><span class="charoverride15">E</span><span class="charoverride5">, the emitter  is basically connected to ground. Change R</span><span class="charoverride15">C</span><span class="charoverride5"> to 470 Ω to reduce the circuit’s gain. Measure gain and compare it to the calculated value from Eq 2 if </span><span class="charoverride13">R</span><span class="charoverride20">E</span><span class="charoverride5"> = 0. (A</span><span class="charoverride15">V</span><span class="charoverride5"> = –470 / 65 = –72.3.) Keep going and add a 10 μF capacitor for C</span><span class="charoverride15">OUT</span><span class="charoverride5"> and a 470 Ω resistor for R</span><span class="charoverride15">L</span><span class="charoverride5">. Calculate gain using Eq 3  (A</span><span class="charoverride15">V</span><span class="charoverride5"> ≈ –36.2) and see if your circuit behaves as expected.</span></p>
<p class="subhead2"><span class="charoverride12">Miller Effect</span></p>
<p class="body-text18"><span class="charoverride5">Another internal component that is surprising to the beginning designer trying to get gain at high frequencies is the </span><span class="charoverride13">Miller capacitance, C</span><span class="charoverride20">M</span><span class="charoverride5">. This is partially a real capacitance created by the transistor’s internal structure and partially caused by the inverting amplifier configuration. Both bipolar and FETs have some parasitic capacitance from the input (base or gate) to the output (collector or drain for an inverting amplifier or switch circuit). Working with FETs now, that gate-to-drain capacitance is C</span><span class="charoverride15">dg</span><span class="charoverride5">. As Miller discovered in 1920 when working with vacuum tube amplifiers, the gain of the circuit (–</span><span class="charoverride13">A</span><span class="charoverride20">V</span><span class="charoverride13">) </span><span class="charoverride5">also amplified the effect of the capacitance, essentially creating a larger capacitor with a value:</span></p>
<table class="calibre25">
<tr class="calibre9"><td class="calibre10"><p class="body-text18"><span class="charoverride13">C</span><span class="charoverride20">M</span><span class="charoverride13"> = C</span><span class="charoverride20">dg</span><span class="charoverride13"> (</span><span class="charoverride5">1</span><span class="charoverride13"> + A</span><span class="charoverride20">V</span><span class="charoverride13">)</span></p></td><td class="calibre27"><p class="body-text18"><span class="charoverride5">	[Eq 4]</span></p></td></tr>
</table>
<p class="body-text18"><span class="charoverride5">This </span><span class="charoverride13">Miller effect</span><span class="charoverride5"> occurs for any inverting amplifier with internal or external capacitance between the input and output: the amplifier’s output moving in the opposite direction to the input makes the capacitor look much bigger than it really is.</span><span class="charoverride14"><a id="ft19" href="part0009_split_005.html#fn19">2</a></span><span class="charoverride5"> (This is true for any type of feedback impedance — here we are limiting the discussion to capacitance.)</span></p>
<p class="body-text18"><span class="charoverride5">The Miller effect can be observed fairly easily by turning on an FET while watching the gate voltage. Figure 3 shows an </span><span class="charoverride13">LTSpiceIV</span><span class="charoverride5"> schematic that we’ll use for a circuit simulation that shows the effects of C</span><span class="charoverride15">M</span><span class="charoverride5">.</span><span class="charoverride14"><a id="ft20" href="part0009_split_005.html#fn20">3</a></span><span class="charoverride5"> The magnitude of this circuit’s voltage gain is:</span></p>
<p class="figure"><img src="../images/00139.jpeg" alt="" class="calibre5"/></p>
<table class="calibre25">
<tr class="calibre9"><td class="calibre10"><p class="body-text18"><span class="charoverride13">A</span><span class="charoverride20">v</span> = <span class="charoverride13">g</span><span class="charoverride20">m</span> <span class="charoverride13">R</span><span class="charoverride20">d</span></p></td><td class="calibre27"><p class="body-text18"><span class="charoverride5">	[Eq 5]</span></p></td></tr>
</table>
<p class="body-text18"><span class="charoverride5">For the 2N7002 enhancement-mode MOSFET used here, </span><span class="charoverride13">g</span><span class="charoverride20">m</span><span class="charoverride5"> is specified to be 320 mS.</span><span class="charoverride14"><a id="ft21" href="part0009_split_005.html#fn21">4</a></span><span class="charoverride5"> With an </span><span class="charoverride13">R</span><span class="charoverride20">d</span><span class="charoverride5"> of 1 kΩ, voltage gain </span><span class="charoverride5">would be quite high, A</span><span class="charoverride15">V</span><span class="charoverride5"> = 1000 </span><span class="charoverride5">×</span><span class="charoverride5"> 0.32 = 320. So the FET’s small reverse transfer ca</span><span class="charoverride5">pacitance, C</span><span class="charoverride15">rss</span><span class="charoverride5"> = 4 pF, is turned into 4 </span><span class="charoverride5">×</span><span class="charoverride5"> 320 = 1280 pF by the circuit’s voltage gain!</span></p>
<p class="body-text18"><span class="charoverride5">You can see this yourself with a suitable oscilloscope and signal generator. To give you an idea of what you’re looking for, though, Figure 4A shows what happens as a fast input pulse is applied to the 2N7002’s gate. (The </span><span class="charoverride13">LTSpiceIV</span><span class="charoverride5"> voltage source values are set to produce a 0 to 5 V pulse beginning at 100 ns with a rise and fall time of 1 ns, a pulse width of 1 ms, and a repetition rate of 10 ms. The simulation’s  .TRAN parameters configure the simulation to begin at 0 seconds and run for 1 </span><span class="charoverride5" xml:lang="ar-SA">μ</span><span class="charoverride5">s with a time step of 0.1 ns.) Voltage traces are taken at the FET drain (V</span><span class="charoverride15">out</span><span class="charoverride5">) and the FET gate (V</span><span class="charoverride15">gate</span><span class="charoverride5">).</span></p>
<p class="figure"><img src="../images/00140.jpeg" alt="" class="calibre5"/></p>
<p class="body-text18"><span class="charoverride5">As you can see in Figure 4A, the gate voltage rises quickly but then abruptly flattens out at about 2.5 V and stays there for about 15 ns before rising again toward the final value of 5 V. At the same time, the output voltage, V</span><span class="charoverride15">out</span><span class="charoverride5">, starts with a sharp upward transient due to the input signal feeding through to the output through C</span><span class="charoverride15">rss</span><span class="charoverride5"> with the FET still off and gain almost zero. </span></p>
<p class="body-text18"><span class="charoverride5">When the gate voltage, V</span><span class="charoverride15">gs</span><span class="charoverride5">, reaches its threshold voltage of 2.5 V, though, the  FET starts to turn on and gain increases to its full value. Now the full Miller effect is in evidence as the rapid increase in capacitance “soaks up” any charge being pumped into the gate by the input pulse. This lasts until the drain voltage reaches zero and is no longer changing. That also ends the Miller effect and V</span><span class="charoverride15">gs</span><span class="charoverride5"> resumes its climb to the final value of 5 V.</span></p>
<p class="body-text18"><span class="charoverride5">The 2N7002 is a very small MOSFET designed for light-duty switching. What happens when a larger FET is used? Change the 2N7002 to an IRF510 (right-click on the FET symbol and select </span><span class="scbf4">PICK NEW MOSFET</span><span class="charoverride5">) and re-run the simulation after changing the stop time in the simulation  to 1 </span><span class="charoverride5" xml:lang="ar-SA">μ</span><span class="charoverride5">s. Wow! Figure 4B shows that the much larger device with at least 20 pF of capacitance experiences a much larger Miller effect, causing V</span><span class="charoverride15">gs</span><span class="charoverride5"> to stay “flat” for 350 nsec. To turn this much larger device on and off quickly — either as a switch or an RF amplifier — the gate drive circuit has to be able to drive a much larger load than for the 2N7002. This is why special gate driver ICs are often used with larger FETs.</span></p>
<p class="body-text18"><span class="charoverride5">You can build this circuit on your workbench if you have a suitably fast oscilloscope and a signal generator capable of producing pulses with fast rise times. I recommend using the “dead bug” or “Manhattan-style” construction techniques presented in Experiment #90 to minimize the effects of stray capacitance and inductance present on solderless breadboards. A 5 V logic gate can serve as a fast pulse source, as well. Use a Schmitt trigger (74HC14 or equivalent) to square up a pulse with longer rise and fall times. </span></p>
<p class="body-text18"><span class="charoverride5">When you start using your scope, remember that you are looking for events that occur in a short period of time, immediately after the FET gate voltage begins to rise. Trigger on the leading edge of the drive pulse — either using a dc threshold or a positive-going slope. If you’re using an IC to generate the pulse, trigger off the input to the gate to create a short delay between triggering the scope and the flattening out of the waveform. Set time/division on the horizontal sweep to be something approximately like the simulated waveform’s time scale. Then zoom in and look for that curious plateau as suddenly, “It’s Miller time!”</span></p>
<p class="notes3"> </p>
<p class="notes3"> </p>
<p class="notes3"> </p>
<p class="notes3"><span class="charoverride12">Notes</span></p>
<p class="notes3"><span class="charoverride22">1</span><span class="charoverride5">All previous “Hands-On Radio” experiments are available to ARRL members at </span><span class="charoverride12"><a href="http://www.arrl.org/hands-on-radio" class="calibre7">www.arrl.org/hands-on-radio</a></span><span class="charoverride5">.</span></p>
<p class="notes3"><span class="charoverride22"><a id="fn19" href="part0009_split_005.html#ft19">2</a></span><span class="charoverride5">N1090-D “Understanding and Predicting Power MOSFET Switching Behavior,” OnSemi, </span><span class="charoverride12"><a href="http://www.onsemi.com/pub_link/Collateral/AN1090-D.PDF" class="calibre7">www.onsemi.com/pub_link/Collateral/AN1090-D.PDF</a></span><span class="charoverride5">.</span></p>
<p class="notes3"><span class="charoverride22"><a id="fn20" href="part0009_split_005.html#ft20">3</a></span><span class="charoverride13">LTSpiceIV </span><span class="charoverride5">is available for downloading from the Linear Technology website as described in “Hands-On Radio” Experiments 83 – 86 which also discuss how to use the simulator. The circuit schematic file for this experiment is available on the “Hands-On Radio” website’s page for this experiment.</span></p>
<p class="notes3"><span class="charoverride22"><a id="fn21" href="part0009_split_005.html#ft21">4</a></span><span class="charoverride5">g</span><span class="charoverride32">m</span><span class="charoverride5"> is transconductance in amps/volt <a id="_idTextAnchor001" class="calibre7"></a>with units of siemens (S).</span></p>


<div class="calibre11" id="calibre_pb_10"></div>
</div>
</body></html>
