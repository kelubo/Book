<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>c01</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="../stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="../page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body id="4OIQ0-4cbd95e5336c4fe1b8728c179770ce3b" class="calibre">
<div id="c01" class="calibre1">
<p class="experiment-number1" id="t4"><span class="charoverride12">Experiment #141 — Window Comparators and Null Detectors</span></p>
<p class="body-text9"><span class="charoverride5">In the early days of Hands-On Radio, one of the first experiments (#11) described comparator circuits.</span><span class="charoverride14"><a id="ft10" href="part0005_split_003.html#fn10">1</a></span><span class="charoverride5"> These are pretty handy for detecting when the voltage at one of their inputs is greater or less than at the other input. I’m finally getting around to describing two variations of the comparator — the </span><span class="charoverride13">window comparator</span><span class="charoverride5"> and the </span><span class="charoverride13">null detector</span><span class="charoverride5">. There are plenty of applications for these circuits in radio and for test circuits.</span></p>
<p class="subhead1"><span class="charoverride12">The Window Comparator</span></p>
<p class="body-text9"><span class="charoverride5">Figure 1 shows a comparator circuit that incorporates hysteresis to shift the setpoint “a little bit” when the output changes state. That helps prevent “chatter” — rapid on-off switching of the output due to noise on the input signal or voltage reference. This comparator-with-hysteresis is known as a </span><span class="charoverride13">Schmitt trigger</span><span class="charoverride5">. Schmitt triggers are so useful that logic ICs intended for interfacing to switch and analog signals use them at gate inputs. Typical parts are the CD4093 and CD40106, along with variations of the 7414.</span></p>
<p class="figure"><img src="../images/00013.jpeg" alt="" class="calibre5"/></p>
<p class="body-text9"><span class="charoverride5">The comparator provides information about a single level — is the input voltage higher or lower than the setpoint? It is often more useful to know if an input voltage is between an upper and lower limit. This type of comparator is a </span><span class="charoverride13">window comparator</span><span class="charoverride5">, sometimes called a </span><span class="charoverride13">range detector.</span></p>
<p class="body-text9"><span class="charoverride5">The window comparator in Figure 2 is simply a pair of comparator circuits — one detects whether the input is below the lower limit and the other detects when it is higher than the upper limit. Hysteresis is not included in order to keep the circuit simple. (Power and ground for the LM393 are on Pins 8 and 4 in the DIP and SOIC packages.) </span></p>
<p class="figure"><img src="../images/00014.jpeg" alt="" class="calibre5"/></p>
<p class="body-text9"><span class="charoverride5">The comparator setpoint voltages (labeled Upper Limit and Lower Limit) are easy to calculate: Upper Limit = V+ </span><span class="charoverride5">×</span><span class="charoverride5"> (R2+R3)/(R1+R2+R3) = 2/3 V+ and Lower Limit = </span><span class="charoverride18">1</span><span class="charoverride5">⁄</span><span class="charoverride18">3</span><span class="charoverride5"> V+. If V+ is 12 V, then the two limits are 8 V and 4 V, creating a 4 V window from 4 to 8 V.</span></p>
<p class="body-text9"><span class="charoverride5">Remember that the output of the comparator is an open-collector transistor acting as a switch that can be open or closed. By connecting the output to a pull-up resistor (R4 in Figure 2) the output voltage is </span><span class="scbf">HIGH</span><span class="charoverride5"> when the transistor is off (approximately V+) and </span><span class="scbf">LOW</span><span class="charoverride5"> (at the transistor’s collector-emitter saturation voltage) when the transistor is on. </span><span class="charoverride5">When the comparator’s non-inverting (+) input is at a higher voltage than the non-inverting (–) input, the output is </span><span class="scbf">HIGH</span><span class="charoverride5">. When the opposite is true (non-inverting input lower than the inverting input) then the open-collector transistor output is </span><span class="scbf">LOW</span><span class="charoverride5">.</span></p>
<p class="body-text9"><span class="charoverride5">Connecting both comparator outputs together creates a </span><span class="charoverride13">wired-AND</span><span class="charoverride5"> gate in which </span><span class="charoverride13">both</span><span class="charoverride5"> output transistors must be </span><span class="scbf">HIGH</span><span class="charoverride5"> to allow the voltage at R4 to rise and turn on Q1, lighting the LED. If either comparator output is </span><span class="scbf">LOW</span><span class="charoverride5">, Q1 remains off. For the window comparator, if the input voltage is higher than Upper Limit, the output of U1A is </span><span class="scbf">LOW</span><span class="charoverride5"> and Q1 is off. If the input voltage is lower than Lower Limit, the output of U1B is </span><span class="scbf">LOW</span><span class="charoverride5"> and Q1 is off. The only condition in which both comparator outputs are </span><span class="scbf">HIGH</span><span class="charoverride5"> occurs when the input voltage is between Upper Limit and Lower Limit.</span></p>
<p class="subhead1"><span class="charoverride12">Look In the Window</span></p>
<p class="body-text9"><span class="charoverride5">Build the circuit, using either a variable power supply or adjustable resistor to create the input voltage. Vary the input voltage from below 4 V to above 8 V, while watching the LED. It will turn on when the input voltage is in the target window.</span></p>
<p class="body-text9"><span class="charoverride5">Now experiment with the value of R2 by substituting fixed-value resistors or using an adjustable resistor. What happens to the window range as R2 is increased? (The window range increases.) Why? (A higher value for R2 lowers Lower Limit and increases Upper Limit.) Decrease R2 and verify that the opposite effect occurs. Return R2 to 3.3 k</span><span class="charoverride5">Ω</span><span class="charoverride5"> and increase the value of R3 — what happens to the window? (The window shifts higher.) Return R3 to 3.3 k</span><span class="charoverride5">Ω</span><span class="charoverride5"> and increase the value of R1 to observe the effect on the window. (It shifts lower.)</span></p>
<p class="body-text9"><span class="charoverride5">If you used a different voltage for V+ the values of Upper Limit and Lower Limit would change right along with it. What if there was noise on the power supply output? Or if you were using a battery supply — what would happen as the battery discharged? Obviously, it’s not a good idea to use an unregulated voltage source for your setpoints. Some kind of regulated voltage is necessary. (Note that if you use a bipolar supply with Pin 4 of U1 and the negative end of R3 connected to the negative supply voltage, the window limits can be made positive or negative.)</span></p>
<p class="body-text9"><span class="charoverride5">This is such a common circuit that many manufacturers offer single and dual comparator ICs with a voltage reference built in. One such IC is the Linear Technology LTC1442.</span><span class="charoverride14">2</span><span class="charoverride5"> You can also use a Zener diode or voltage reference IC. Regardless, for consistent and reliable operation, the voltage source to which the voltage divider string of R1, R2, and R3 must be clean and stable. It is good practice, particularly around RF sources like transmitters, to include small-value capacitors (such as 0.01 </span><span class="charoverride5" xml:lang="ar-SA">µ</span><span class="charoverride5">F) from each setpoint to ground.</span></p>
<p class="body-text9"><span class="charoverride5">Window comparators are useful for lots of radio-related chores: making sure your power supply or battery voltage is in the right range, for example. If you sample some RF power and use a peak detector as described in the previous column, a window comparator can be used to make sure the power is within a desired range. Another use is for decoding the Icom transceiver BAND data output that changes from 0 to 7 V with the band selected. K6XX has designed a circuit that uses an LED meter driver IC with many window comparators built in to sort the voltage levels into digital-compatible outputs.</span><span class="charoverride14">3</span></p>
<p class="subhead1"><span class="charoverride12">Null Detector</span></p>
<p class="body-text9"><span class="charoverride5">There are many instances in which it’s useful to adjust a circuit or system to produce a voltage exactly equal to some reference level, such as when balancing a bridge circuit or trying to adjust dc offset in an amplifier or demodulator circuit. A special type of window detector called a </span><span class="charoverride13">null detector</span><span class="charoverride5"> responds to a narrow range right around a  0 V difference between its two inputs. “Null” in this case means “no difference between” the voltage being measured and a reference voltage.</span></p>
<p class="body-text9"><span class="charoverride5">Figure 3A shows a null detector circuit that uses an analog center-zero meter to allow fine adjustments to obtain the null. The input section consisting of U1A, R1, and R2 sets the gain of the detector equal to  R2 / R1. The higher the gain, the more sensitive the detector. Note that U1 is a dual op-amp and not a dual comparator! A bipolar power supply of at least </span><span class="charoverride5" xml:lang="ar-SA">±</span><span class="charoverride5">6V should be used.</span></p>
<p class="figure"><img src="../images/00015.jpeg" alt="" class="calibre5"/></p>
<p class="body-text9"><span class="charoverride5">U1B converts the voltage at the non-inverting input into current through the meter. R3 calibrates the voltage-to-current ratio: I = V / R3. If R3 is 1k</span><span class="charoverride5">Ω</span><span class="charoverride5">, then 1 V at the non-inverting input to U1B is converted to 1 mA of current through the meter. (1-0-1 mA center-zero meters are often used with a shunt for battery charging systems.)</span></p>
<p class="body-text9"><span class="charoverride5">To calibrate the meter; set R2 to 10 k</span><span class="charoverride5">Ω</span><span class="charoverride5"> so that gain equals 1, ground V</span><span class="scbf1">ref</span><span class="charoverride5">, </span><span class="charoverride5">then connect a voltage of 0 to 1 V to the input. Measure the voltage at the output of U1A and adjust R2 so that the meter shows the same number of mA. i.e. – for a voltage of +0.5 V, the meter should indicate 0.5 mA in the positive direction.</span></p>
<p class="body-text9"><span class="charoverride5">To use the null detector, connect V</span><span class="scbf1">ref</span><span class="charoverride5"> to the reference voltage desired, whether 0 V or some other value, and adjust input gain (R2) to the desired sensitivity. For initial adjustments of the external circuit being measured, keep gain low. As the null is reached, increase input gain for more and more sensitive adjustments.</span></p>
<p class="body-text9"><span class="charoverride5">An alternative to the analog meter is shown in Figure 3B, a pair of LEDs connected back-to-back. The calibration pot, R3, is adjusted with V</span><span class="scbf1">ref</span><span class="charoverride5"> and Input shorted so that both LEDs are dark. (Noise, hum, or ripple on either signal may cause the LEDs to light dimly. A 0.1 </span><span class="charoverride5" xml:lang="ar-SA">µ</span><span class="charoverride5">F capacitor across R2 creates a low-pass filter to avoid responding to ac components.) If the input voltage is higher than V</span><span class="scbf1">ref</span><span class="charoverride5">, then the bottom LED will be dark and the top LED will be lit. This is often sufficient to adjust a circuit or balance a bridge without requiring a high-precision display.</span></p>
<p class="subhead1"><span class="charoverride12">Parts List</span></p>
<p class="body-text16"><span class="charoverride5">LM393 dual comparator (or equivalent)</span></p>
<p class="body-text16"><span class="charoverride5">TL082 dual op-amp (or equivalent)</span></p>
<p class="body-text16"><span class="charoverride5">2N3904 NPN transistor</span></p>
<p class="body-text16"><span class="charoverride5">Standard LED (2)</span></p>
<p class="body-text16"><span class="charoverride5">470 </span><span class="charoverride5">Ω</span><span class="charoverride5">, 3.3 k</span><span class="charoverride5">Ω</span><span class="charoverride5"> (3 ea.), 10 k</span><span class="charoverride5">Ω</span><span class="charoverride5"> (2 ea.)   ¼-watt, 5% resistors</span></p>
<p class="body-text16"><span class="charoverride5">5 k</span><span class="charoverride5">Ω</span><span class="charoverride5">, 10 k</span><span class="charoverride5">Ω</span><span class="charoverride5"> trimpot</span></p>
<p class="body-text2"><span class="charoverride5">1-0-1 mA center-zero dc milliammeter   (optional)</span></p>
<p class="notes"> </p>
<p class="notes"> </p>
<p class="notes"> </p>
<p class="notes"><span class="charoverride19"><a id="fn10" href="part0005_split_003.html#ft10">1</a></span><span class="charoverride5">All previous Hands-On Radio experiments are available to ARRL members at </span><span class="hyperlink1"><a href="http://www.arrl.org/hands-on-radio" class="calibre7">www.arrl.org/hands-on-radio</a></span>.</p>


<div class="calibre11" id="calibre_pb_6"></div>
</div>
</body></html>
