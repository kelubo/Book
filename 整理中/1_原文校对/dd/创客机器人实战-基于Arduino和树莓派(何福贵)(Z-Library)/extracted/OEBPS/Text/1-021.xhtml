<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" xml:lang="zh-CN">
  <head>
    <title>未知</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link rel="stylesheet" type="text/css" href="../../stylesheet.css"/>
<link rel="stylesheet" type="text/css" href="../../page_styles.css"/>
</head>
  <body class="calibre"> 
 <h2 id="A050a0103-4e2f-4fd9-b4bb-bd3621cffd7f" class="calibre13">Chapter 15<br class="calibre8"/> 第十五章 树莓派语音处理</h2> 
 <p class="calibre3">在人工智能快速发展的今天，语音识别开始成为很多智能设备的标配，语音识别开始被越来越多的人关注，树莓派也已经实现了许多类似的应用，例如语音天气播报和闹钟铃音、语音聊天机器人、语音智能音乐小管家等，本章介绍树莓派语音处理的相关内容。</p> 
 <h3 id="A2c7fbb92-9600-46ec-bc99-f76152e08d47" class="calibre14">15.1 树莓派播放语音</h3> 
 <h4 class="sigil_not_in_toc" id="A998c0103-5868-4711-a27e-c22c08e8253c">15.1.1 树莓派播放声音的硬件</h4> 
 <p class="calibre3">树莓派有两种音频输出模式：HDMI和耳机接口，如图15-1所示，可以在任何时候切换这两种模式。</p> 
 <div class="center"> 
  <img alt="" class="u601" src="../Images/260_01.jpg" width="930" height="716"/> 
  <p class="imgtitle">图15-1 树莓派两种音频输出模式</p> 
 </div> 
 <p class="calibre3">如果HDMI显示器有内置的音箱，可以通过HDMI接口播放音频，也可以切换到耳机接口，使用耳机或者其他耳机接口的音箱播放。如果显示器请求音箱支持，声音默认通过HD-MI输出；如果没有，那么将通过耳机接口输出，这种情况可以手动选择。</p> 
 <p class="calibre3">除了树莓派本身播放音频的接口之外，也可以使用树莓派扩展板声卡，如图15-2所示。树莓派扩展板集成了TI公司专业的音频解码芯片PCM5122，采用I2S接口标准，整合了一套基于树莓派的完善的音频硬件解码系统。并支持Volumio、RuneAudio、OSMC等功能强大的播放软件。</p> 
 <div class="center"> 
  <img alt="" class="u602" src="../Images/261_01.jpg" width="1280" height="629"/> 
  <p class="imgtitle">图15-2 树莓派扩展板声卡</p> 
 </div> 
 <h4 class="sigil_not_in_toc" id="A35660104-cdae-4b85-8569-6a0deecb1651">15.1.2 Omxplayer播放器</h4> 
 <p class="calibre3">Omxplayer是一个可以运行在树莓派系统的播放软件，Omxplayer能够播放的媒体格式有：MP3、MP4、WAV、AVI和FLV等。Omxplayer播放器具有以下特点：</p> 
 <p class="calibre3">（1）Omxplayer支持硬解码。</p> 
 <p class="calibre3">（2）支持的文件格式有：MP3、MP4、WAV、AVI和FLV。</p> 
 <p class="calibre3">（3）如果使用HDMI输出声音，参数是：-o hdmi，并且文件/boot/config.txt里面的HD-MI_DRIVER=2。</p> 
 <p class="calibre3">（4）可全屏播放，全屏播放的参数是：-r。</p> 
 <p class="calibre3">播放器Omxplayer的安装方法：在树莓派控制终端输入以下命令，sudo apt-get install omxplayer，如图15-3所示。</p> 
 <p class="calibre3">Omxplayer播放音频文件的命令格式如下：</p> 
 <div class="center">
  <img alt="" class="u603" src="../Images/261_02.jpg" width="1280" height="43"/>
 </div> 
 <p class="calibre3">-o说明了输出源，-r说明全屏幕播放。在运行omxplayer播放音频文件时，使用'+'和'-'按键能够控制播放的声音大小。</p> 
 <p class="calibre3">例如：sudo omxplayer-o local 06.mp3，Omxplayer通过树莓派主板的Audio口播放MP3文件，通过'+'和'-'按键能够控制播放的声音大小，如图15-4所示。</p> 
 <div class="center"> 
  <img alt="" class="u604" src="../Images/262_01.jpg" width="1280" height="781"/> 
  <p class="imgtitle">图15-3 安装Omxplayer</p> 
 </div> 
 <div class="center"> 
  <img alt="" class="u605" src="../Images/262_02.jpg" width="1280" height="598"/> 
  <p class="imgtitle">图15-4 Omxplayer播放音频文件</p> 
 </div> 
 <h4 class="sigil_not_in_toc" id="Ade220105-7545-4c87-b6cb-c4af00ce2df9">15.1.3 Rhythmbox播放器</h4> 
 <p class="calibre3">Rhythmbox是Linux下的音乐播放和管理软件，是Fedora和Ubuntu等Linux发行版默认安装的音乐播放器。它可以播放各种音频格式的音乐，以及管理收藏音乐。</p> 
 <p class="calibre3">Rhythmbox的安装方法：在树莓派控制终端输入以下命令：sudo apt-get install rhythmbox，如图15-5所示。</p> 
 <p class="calibre3">安装完成以后，在树莓派的“开始”菜单选择“影音”＞“Rhythmbox”命令，打开播放器，如图15-6所示。</p> 
 <p class="calibre3">正常情况下，安装完成后，也是无法直接播放MP3格式的文件的，因为版权问题，一般Linux不带MP3的解码程序，需要手动安装解码程序，安装方法如下：</p> 
 <div class="center"> 
  <img alt="" class="u606" src="../Images/263_01.jpg" width="1201" height="1077"/> 
  <p class="imgtitle">图15-5 Rhythmbox的安装</p> 
 </div> 
 <div class="center"> 
  <img alt="" class="u607" src="../Images/263_02.jpg" width="1280" height="648"/> 
  <p class="imgtitle">图15-6 打开Rhythmbox播放器</p> 
 </div> 
 <p class="calibre3">（1）下载gst-fluendo-mp3，地址为：http://core.fluendo.com/gstreamer/src/gst-fluendo-mp3/，如图15-7所示。</p> 
 <p class="calibre3">（2）下载最新版本的gst-fluendo-mp3-0.10.32.tar.gz，然后解压，如图15-8所示。</p> 
 <p class="calibre3">（3）通过cd命令进入到解压后的目录，输入命令：./configure，开始配置，如图15-9所示。</p> 
 <div class="center"> 
  <img alt="" class="u608" src="../Images/264_01.jpg" width="1050" height="1382"/> 
  <p class="imgtitle">图15-7 下载gst-fluendo-mp3</p> 
 </div> 
 <div class="center"> 
  <img alt="" class="u609" src="../Images/264_02.jpg" width="1016" height="739"/> 
  <p class="imgtitle">图15-8 解压gst-fluendo-mp3</p> 
 </div> 
 <p class="calibre3">（4）输入命令：make install，开始安装，安装完成之后，Rhythmbox就可以播放MP3格式的音乐文件了。</p> 
 <div class="center"> 
  <img alt="" class="u610" src="../Images/265_01.jpg" width="1113" height="522"/> 
  <p class="imgtitle">图15-9 配置gst-fluendo-mp3</p> 
 </div> 
 <h4 class="sigil_not_in_toc" id="Acc010108-1af3-4fdf-8a83-c4260c610094">15.1.4 Volumio、RuneAudio和OSMC播放系统</h4> 
 <p class="calibre3">Volumio、RuneAudio和OSMC是树莓派功能强大的播放软件，下面分别介绍。</p> 
 <p class="calibre3"><b class="calibre6">1．RuneAudio</b></p> 
 <p class="calibre3">Runeaudio是一个自由和开放的源码软件，可以将嵌入式系统变为高保真音乐播放器。Runeaudio的主页网址为：http://www.runeaudio.com，如图15-10所示。可以从主页下载树莓派的Runeaudio映像文件。运行Win32Disk Imager系统烧录软件即可烧写映像文件。</p> 
 <div class="center"> 
  <img alt="" class="u611" src="../Images/265_02.jpg" width="1161" height="641"/> 
  <p class="imgtitle">图15-10 Runeaudio</p> 
 </div> 
 <p class="calibre3"><b class="calibre6">2．Volumio</b></p> 
 <p class="calibre3">Volumio是一个免费开源的音乐播放器，Volumio的主页网址为：https：//volumio.org/，如图15-11所示，可以从主页下载树莓派的Volumio映像文件。运行Win32Disk Imager系统烧录软件即可烧写映像文件。</p> 
 <div class="center"> 
  <img alt="" class="u612" src="../Images/265_03.jpg" width="827" height="604"/> 
  <p class="imgtitle">图15-11 Volumio</p> 
 </div> 
 <p class="calibre3">将烧写映像文件TF卡插入树莓派，上电启动，出现Login界面（user：volumio，passwd：volumio），等待几分钟之后使用计算机搜索热点，会发现有一个volumio的热点，连接此Wi-Fi，密码是volumio2。如图15-12所示。</p> 
 <div class="center"> 
  <img alt="" class="u613" src="../Images/266_01.jpg" width="778" height="1127"/> 
  <p class="imgtitle">图15-12 连接热点</p> 
 </div> 
 <p class="calibre3">连接成功之后在计算机的浏览器输入：http://volumio.local/，显示Volumio的Web界面则大功告成，如图15-13所示。</p> 
 <div class="center"> 
  <img alt="" class="u614" src="../Images/266_02.jpg" width="1280" height="617"/> 
  <p class="imgtitle">图15-13 计算机上运行Volvmio</p> 
 </div> 
 <p class="calibre3"><b class="calibre6">3．OSMC</b></p> 
 <p class="calibre3">OSMC是一款基于Linux的免费开源的媒体播放系统。目前支持树莓派1、2、3、zero、vero、Apple TV等几款硬件平台。OSMC的主页网址为：https：//osmc.tv/，如图15-14所示，可以从主页下载树莓派的OSMC安装软件。</p> 
 <div class="center"> 
  <img alt="" class="u615" src="../Images/267_01.jpg" width="1149" height="608"/> 
  <p class="imgtitle">图15-14 OSMC</p> 
 </div> 
 <p class="calibre3">OSMC安装的方法如下：</p> 
 <p class="calibre3">（1）在OSMC的官网（https：//osmc.tv/download/）下载安装软件，如图15-15所示，OSMC的安装软件目前提供了3种平台：Windows、OS X、Linux，下面以Windows为例进行说明。</p> 
 <div class="center"> 
  <img alt="" class="u616" src="../Images/267_02.jpg" width="1067" height="897"/> 
  <p class="imgtitle">图15-15 OSMC安装软件下载</p> 
 </div> 
 <p class="calibre3">（2）下载的软件为osmc-installer.exe，运行osmc-installer.exe软件，开始OSMC系统的安装。选择“English”，平台选择“Raspberry Pi 2/3”，如图15-16所示。</p> 
 <p class="calibre3">（3）单击<img alt="" class="u617" src="../Images/267_03.jpg" width="78" height="39"/>按钮进入选择版本的界面，如图15-17所示，这里选择最新的“2018.01-1”，“use a local build on my computer”用于设置是否使用本地文件。</p> 
 <p class="calibre3">（4）单击<img alt="" class="u618" src="../Images/267_04.jpg" width="78" height="40"/>按钮进入选择烧写设备类型的界面，如图15-18所示，这里选用SD卡。</p> 
 <p class="calibre3">（5）单击<img alt="" class="u617" src="../Images/267_05.jpg" width="78" height="39"/>按钮进入选择网络连接方式的界面，如图15-19所示，这里选择“wireless connect”无线连接。</p> 
 <div class="center"> 
  <img alt="" class="u619" src="../Images/268_01.jpg" width="831" height="703"/> 
  <p class="imgtitle">图15-16 OSMC运行界面</p> 
 </div> 
 <div class="center"> 
  <img alt="" class="u620" src="../Images/268_02.jpg" width="803" height="707"/> 
  <p class="imgtitle">图15-17 选中版本</p> 
 </div> 
 <div class="center"> 
  <img alt="" class="u621" src="../Images/268_03.jpg" width="790" height="641"/> 
  <p class="imgtitle">图15-18 选择烧写设备类型</p> 
 </div> 
 <div class="center"> 
  <img alt="" class="u622" src="../Images/268_04.jpg" width="792" height="644"/> 
  <p class="imgtitle">图15-19 选择网络连接方式</p> 
 </div> 
 <p class="calibre3">（6）单击<img alt="" class="u617" src="../Images/268_05.jpg" width="79" height="39"/>按钮进入选择网络连接设置的界面，如图15-20所示，选择网络账号和密码。</p> 
 <p class="calibre3">（7）单击<img alt="" class="u618" src="../Images/268_06.jpg" width="79" height="40"/>按钮进入选择烧写系统的SD卡，切记不要选错，如图15-21所示。</p> 
 <div class="center"> 
  <img alt="" class="u623" src="../Images/268_07.jpg" width="845" height="685"/> 
  <p class="imgtitle">图15-20 选择网络账号和密码</p> 
 </div> 
 <div class="center"> 
  <img alt="" class="u624" src="../Images/268_08.jpg" width="838" height="682"/> 
  <p class="imgtitle">图15-21 选择烧写系统的SD卡</p> 
 </div> 
 <p class="calibre3">（9）单击<img alt="" class="u618" src="../Images/269_01.jpg" width="78" height="40"/>按钮进入烧写系统，如图15-22所示。</p> 
 <div class="center"> 
  <img alt="" class="u625" src="../Images/269_02.jpg" width="1280" height="533"/> 
  <p class="imgtitle">图15-22 开始烧写</p> 
 </div> 
 <p class="calibre3">将烧写映像文件TF卡插入树莓派，上电启动，开机初始化。第一次启动会要求配置时间、地区、语言等，配置完成显示主界面，如图15-23所示。</p> 
 <div class="center"> 
  <img alt="" class="u626" src="../Images/269_03.jpg" width="1280" height="716"/> 
  <p class="imgtitle">图15-23 OSMC主界面</p> 
 </div> 
 <p class="calibre3"><b class="calibre6">注意</b>：切勿在初始化设置时更改语言为中文，否则会出现中文字用框框显示的错误。</p> 
 <p class="calibre3">之后开机可以切换为中文，设置方法：选择“settings”＞“apparence”＞“skin”命令，把fonts改成Arial based；之后选择“skin”下的“international”，把“language”改成“Chinese”。</p> 
 <h3 id="Afdf79895-2101-43a0-ad91-f219bf7e7c69" class="calibre14">15.2 使用USB话筒</h3> 
 <p class="calibre3">大家都知道树莓派只有音频输出口，而没有音频输入的接口，怎么办？其实只要一个USB话筒就可以了。要在树莓派上使用话筒功能，关键是要选对话筒的型号，跟摄像头一样，想在Linux上使用，最好都选择Linux免驱动的。如图15-24所示为树莓派专用USB接口免驱动话筒。</p> 
 <div class="center"> 
  <img alt="" class="u627" src="../Images/270_01.jpg" width="833" height="674"/> 
  <p class="imgtitle">图15-24 树莓派专用USB接口话筒</p> 
 </div> 
 <p class="calibre3">将USB接口话筒插入树莓派的USB接口，如图15-25所示。</p> 
 <div class="center"> 
  <img alt="" class="u628" src="../Images/270_02.jpg" width="995" height="523"/> 
  <p class="imgtitle">图15-25 将话筒插入树莓派的USB接口</p> 
 </div> 
 <p class="calibre3">启动树莓派系统，打开终端控制台，输入命令：lsusb，如图15-26所示，CM108即为插入的USB话筒。</p> 
 <div class="center"> 
  <img alt="" class="u629" src="../Images/270_03.jpg" width="1148" height="659"/> 
  <p class="imgtitle">图15-26 lsusb</p> 
 </div> 
 <p class="calibre3">确定接入后，安装录音工具，步骤如下：</p> 
 <p class="calibre3">（1）先更新软件包：</p> 
 <div class="center">
  <img alt="" class="u630" src="../Images/271_01.jpg" width="1280" height="82"/>
 </div> 
 <p class="calibre3">（2）安装必要的程序：</p> 
 <p class="calibre3">sudo apt-get-y installalsa-utils alsa-tools alsa-tools-gui alsamixergui</p> 
 <p class="calibre3">这里安装了必要的录音工具，同时也安装了两个图形界面工具，这样就可以用图形界面来设置音量等，操作比较方便。</p> 
 <p class="calibre3">安装完成后，就可以使用树莓派来录音了。可以写个命令测试一下：sudo arecord-D "plughw：1，0"-d 5 test.wav，如图15-27所示。</p> 
 <div class="center"> 
  <img alt="" class="u631" src="../Images/271_02.jpg" width="1280" height="509"/> 
  <p class="imgtitle">图15-27 arecord录音</p> 
 </div> 
 <p class="calibre3">-D这个参数的意思就是选择设备，外部设备就是plughw：1，0，内部设备就是plughw：0，0。树莓派本身并没有录音模块，故没有内部设备。-d 5的意思就是录制时间为5秒，如果不加这个参数就会一直录音，直到按快捷键Ctrl+C停止，最后是生成的文件名test.wav。</p> 
 <p class="calibre3">如果想要播放音频，可以用Omxplayer软件。如果没有安装，使用下列命令：sudo aptget install omxplayer。</p> 
 <p class="calibre3">安装完成后，使用Omxplayer播放录音文件，命令为：omxplayer-o local test.wav，如图15-28所示。</p> 
 <div class="center"> 
  <img alt="" class="u632" src="../Images/271_03.jpg" width="1280" height="499"/> 
  <p class="imgtitle">图15-28 使用Omxplayer播放录音文件</p> 
 </div> 
 <p class="calibre3">如果没声音，选择“raspi-config”＞“Advanced Options”＞“Audio”命令调整音频输出。</p> 
 <h3 id="Ab4f2f80b-0bf4-40cc-a109-4f0aa91348c5" class="calibre14">15.3 利用树莓派打造语音天气播报</h3> 
 <p class="calibre3">目前，人们可以从一些天气服务器获取实时天气信息，例如，墨迹天气（http://tianqi.moji.com/），如图15-29所示，以及心知天气（https：//www.seniverse.com/），如图15-30所示。</p> 
 <div class="center"> 
  <img alt="" class="u633" src="../Images/272_01.jpg" width="798" height="714"/> 
  <p class="imgtitle">图15-29 墨迹天气主页</p> 
 </div> 
 <div class="center"> 
  <img alt="" class="u634" src="../Images/272_02.jpg" width="909" height="713"/> 
  <p class="imgtitle">图15-30 心知天气主页</p> 
 </div> 
 <p class="calibre3">这里以墨迹天气为例进行介绍。进入墨迹天气页面，墨迹天气会根据你的位置加载相应地区的天气。这里主要提取温度、天气、湿度、风力、空气质量和天气提示等数据。</p> 
 <p class="calibre3">使用requests和BeautifulSoup这两个超级好用的库可以快速实现天气信息的获取，这两个库是Python的第三方库，需要安装，步骤如下：</p> 
 <p class="calibre3">（1）输入命令：$ sudo pip install requests。</p> 
 <p class="calibre3">（2）输入命令：$sudo apt-get install Python-bs4，如图15-31所示。</p> 
 <div class="center"> 
  <img alt="" class="u635" src="../Images/272_03.jpg" width="1085" height="707"/> 
  <p class="imgtitle">图15-31 安装requests和Python-bs4</p> 
 </div> 
 <p class="calibre3">（3）输入将BeautifulSoup安装到Python3命令：$ sudo apt-get install Python-bs4，如图15-32所示。</p> 
 <div class="center"> 
  <img alt="" class="u636" src="../Images/273_01.jpg" width="1113" height="495"/> 
  <p class="imgtitle">图15-32 将BeautifulSoup安装到Python3</p> 
 </div> 
 <p class="calibre3">实现本地文字转语音使用百度的文字转换语音API，主页网址为：http://yuyin.baidu.com/#try，如图15-33所示。</p> 
 <div class="center"> 
  <img alt="" class="u637" src="../Images/273_02.jpg" width="1280" height="646"/> 
  <p class="imgtitle">图15-33 http://yuyin.baidu.com/#try</p> 
 </div> 
 <p class="calibre3">可以选择各种声音，调节语速。虽然它没有给出直接的API接口，但是可以利用Chrome浏览器的开发者模式找到API。</p> 
 <p class="calibre3">百度语音合成API为：http://tts.baidu.com/text2audio？idx=1&amp;amp; amp; tex=1&amp;amp;amp; cuid=baidu_ speech_ demo&amp;amp; amp; cod=2&amp;amp; amp; lan=zh&amp;amp; amp; ctp=1&amp;amp; amp; pdt=1&amp;amp; amp; spd=5&amp;amp; amp; per=4&amp;amp; amp; vol=5&amp;amp; amp;pit=5，其中per参数是语音的类型，spd是语速，vol是音量，而tex则是需要转换的文字。</p> 
 <p class="calibre3">通过以下代码就可以实现将特定的文字转换为语音：</p> 
 <div class="center">
  <img alt="" class="u638" src="../Images/273_03.jpg" width="1280" height="217"/>
 </div> 
 <p class="calibre3">下面使用Omxplayer实现语音播放。</p> 
 <p class="calibre3">启动树莓派，打开Python 3的IDLE窗口，新建文件，输入下列代码，并将文件保存为Voice_Weather.py：</p> 
 <div class="center">
  <img alt="" class="u639" src="../Images/274_01.jpg" width="1280" height="1757"/>
 </div> 
 <div class="center">
  <img alt="" class="u640" src="../Images/275_01.jpg" width="1280" height="1836"/>
 </div> 
 <div class="center">
  <img alt="" class="u641" src="../Images/276_01.jpg" width="1280" height="495"/>
 </div> 
 <p class="calibre3">运行结果如图15-34所示。</p> 
 <div class="center"> 
  <img alt="" class="u642" src="../Images/276_02.jpg" width="1280" height="591"/> 
  <p class="imgtitle">图15-34 语音天气播报运行结果</p> 
 </div> 
 <h3 id="Ace3d27fb-0281-4bda-9c0e-58649a341893" class="calibre14">15.4 利用树莓派打造聊天机器人</h3> 
 <p class="calibre3">利用树莓派实现聊天机器人的硬件包括树莓派系统、USB话筒和播放语音的音响；聊天机器人软件实现包括4部分：语音录入、语音转文字、文字智能对话和播放搜索结果。</p> 
 <h4 class="sigil_not_in_toc" id="A0f110113-6725-4911-8b0a-e9ea085f908a">15.4.1 图灵机器人实现智能对话</h4> 
 <p class="calibre3">图灵机器人是中文语境下智能度最高的机器人大脑，是全球领先的中文语义与认知计算平台。智能对话、知识库、技能服务是图灵机器人的三大核心功能。主页网址为http://www.tuling123.com/，如图15-35所示。</p> 
 <p class="calibre3">图灵机器人的使用步骤如图15-36所示。</p> 
 <p class="calibre3">注册图灵账号后，新建机器人，选择“机器人设置”，显示接入的API地址和APIkey，如图15-37所示。</p> 
 <div class="center"> 
  <img alt="" class="u643" src="../Images/277_01.jpg" width="1280" height="653"/> 
  <p class="imgtitle">图15-35 图灵机器人主页界面</p> 
 </div> 
 <div class="center"> 
  <img alt="" class="u644" src="../Images/277_02.jpg" width="945" height="638"/> 
  <p class="imgtitle">图15-36 图灵机器人的使用步骤</p> 
 </div> 
 <div class="center"> 
  <img alt="" class="u645" src="../Images/277_03.jpg" width="929" height="749"/> 
  <p class="imgtitle">图15-37 接入的API地址和APIkey</p> 
 </div> 
 <p class="calibre3">下面通过一个测试程序测试一下图灵机器人是否正确接入。在树莓派打开Python2的I-DLE窗口，新建文件，输入下列代码，并将文件保存为Tulin_Test.py：</p> 
 <div class="center">
  <img alt="" class="u646" src="../Images/278_01.jpg" width="1280" height="655"/>
 </div> 
 <p class="calibre3">保存之后运行，就可以实现文字对文字的聊天了，运行结果如图15-38所示。</p> 
 <div class="center"> 
  <img alt="" class="u647" src="../Images/278_02.jpg" width="1280" height="384"/> 
  <p class="imgtitle">图15-38 文字对文字的聊天</p> 
 </div> 
 <p class="calibre3">因为这里要的是对话，所以文字输入要变成语音输入。调用百度语音API把文字从语音中提取出来。然后再把图灵机器人回复的文字通过eSpeak通过音响说出来。</p> 
 <h4 class="sigil_not_in_toc" id="A3c6e0115-c95d-4451-ba95-d92467d66640">15.4.2 百度语音识别</h4> 
 <p class="calibre3">百度语音为开发者提供了业界领先、永久免费的语音技术服务，包括语音识别、语义解析、语音合成，支持Java、C/C++等语言，以及Windows、Iinux、Android、iOS等平台。主页网址为http://yuyin.baidu.com/，如图15-39所示。</p> 
 <p class="calibre3">百度语音包括语音识别服务、语音合成服务和语音唤醒服务等。</p> 
 <p class="calibre3">（1）语音识别。</p> 
 <p class="calibre3"><img alt="" class="u58" src="../Images/278_03.jpg" width="40" height="44"/>完全永久免费。</p> 
 <p class="calibre3"><img alt="" class="u58" src="../Images/278_04.jpg" width="40" height="44"/>业界首创的完全永久免费的新形式，为开发者提供了基于百度大脑的业界顶级声学模型和语音模型。由于完全免费，永久使用，彻底摆脱了有效期限制。</p> 
 <div class="center"> 
  <img alt="" class="u648" src="../Images/279_01.jpg" width="1070" height="729"/> 
  <p class="imgtitle">图15-39 百度语音</p> 
 </div> 
 <p class="calibre3"><img alt="" class="u58" src="../Images/279_02.jpg" width="40" height="44"/>全平台REST API。</p> 
 <p class="calibre3"><img alt="" class="u58" src="../Images/279_03.jpg" width="40" height="44"/>行业率先推出语音识别REST API，采用HTTP方式请求，可适用于任何平台的语音识别，给人们提供了最大的自由度。</p> 
 <p class="calibre3"><img alt="" class="u58" src="../Images/279_04.jpg" width="40" height="45"/>离线在线融合模式。</p> 
 <p class="calibre3"><img alt="" class="u58" src="../Images/279_05.jpg" width="40" height="44"/>SDK可以根据当前网络状况及指令的类型，自动判断使用本地引擎还是云端引擎进行语音识别，极速识别、流量节省两不误。</p> 
 <p class="calibre3"><img alt="" class="u58" src="../Images/279_06.jpg" width="40" height="45"/>深度语义解析。</p> 
 <p class="calibre3"><img alt="" class="u58" src="../Images/279_07.jpg" width="40" height="44"/>支持多达35个垂类领域的语义理解定制，以及自定义指令集和问答对设置，使应用能够理解用户的意图。</p> 
 <p class="calibre3"><img alt="" class="u58" src="../Images/279_08.jpg" width="40" height="45"/>场景识别定制。</p> 
 <p class="calibre3"><img alt="" class="u58" src="../Images/279_09.jpg" width="40" height="44"/>开发者可根据使用场景，自定义设置识别垂类模型，有音乐、视频、地图、游戏、电商共17个垂类可供选择。一步设置，精准到位。</p> 
 <p class="calibre3"><img alt="" class="u58" src="../Images/279_10.jpg" width="40" height="44"/>自定义上传语料、训练模型。</p> 
 <p class="calibre3"><img alt="" class="u58" src="../Images/279_11.jpg" width="40" height="45"/>开发者可以自行上传词库，训练专属识别模型。提交的语料越多、越全，语音识别的效果提升也越明显。</p> 
 <p class="calibre3">（2）语音合成。</p> 
 <p class="calibre3"><img alt="" class="u58" src="../Images/279_12.jpg" width="40" height="44"/>完全永久免费。</p> 
 <p class="calibre3"><img alt="" class="u58" src="../Images/279_13.jpg" width="40" height="44"/>业界首创的完全永久免费的新形式，为开发者提供最流畅、最自然的语音合成服务。由于完全免费，永久使用，彻底摆脱了限制。</p> 
 <p class="calibre3"><img alt="" class="u58" src="../Images/279_14.jpg" width="40" height="45"/>离线和在线融合模式。</p> 
 <p class="calibre3"><img alt="" class="u58" src="../Images/279_15.jpg" width="40" height="44"/>SDK可以根据当前网络状况，自动判断使用本地引擎还是云端引擎进行语音合成，再也不用担心流量消耗。</p> 
 <p class="calibre3"><img alt="" class="u58" src="../Images/279_16.jpg" width="40" height="44"/>多语言、多音色可选。</p> 
 <p class="calibre3"><img alt="" class="u58" src="../Images/279_17.jpg" width="40" height="44"/>中文普通话、中英文混读，以及男声、女声任选，更支持语速、音调、音量、音频码率设置，使应用拥有最甜美和最磁性的声音。</p> 
 <p class="calibre3"><img alt="" class="u58" src="../Images/280_01.jpg" width="40" height="44"/>流畅自然的合成效果。</p> 
 <p class="calibre3"><img alt="" class="u58" src="../Images/280_02.jpg" width="40" height="45"/>语音合成技术在业界领先，合成效果接近真人发声，流畅自然，且极具表现力，给每个人最舒适的听觉体验。</p> 
 <p class="calibre3">使用百度语音需要在百度语音网站注册，然后创建新应用，如图15-40所示。</p> 
 <div class="center"> 
  <img alt="" class="u649" src="../Images/280_03.jpg" width="713" height="463"/> 
  <p class="imgtitle">图15-40 创建新应用</p> 
 </div> 
 <p class="calibre3">在创建的新应用的“应用管理”界面，获得API ID、API Key、Secret Key，如图15-41所示。</p> 
 <div class="center"> 
  <img alt="" class="u650" src="../Images/280_04.jpg" width="1280" height="467"/> 
  <p class="imgtitle">图15-41 获得API ID、API Key、Secret Key</p> 
 </div> 
 <p class="calibre3">在树莓派系统安装Python第三方库，命令如下：</p> 
 <div class="center">
  <img alt="" class="u651" src="../Images/280_05.jpg" width="1280" height="220"/>
 </div> 
 <p class="calibre3">下面是一个测试程序，测试一下百度语音转文字的功能。在树莓派打开Python2的IDLE窗口，新建文件，输入下列代码，并将文件保存为baidu_voice.py：</p> 
 <div class="center">
  <img alt="" class="u652" src="../Images/280_06.jpg" width="1280" height="601"/>
 </div> 
 <div class="center">
  <img alt="" class="u653" src="../Images/281_01.jpg" width="1280" height="1183"/>
 </div> 
 <p class="calibre3">在运行代码之前，使用下列命令进行录音：</p> 
 <div class="center">
  <img alt="" class="u551" src="../Images/281_02.jpg" width="1280" height="46"/>
 </div> 
 <p class="calibre3">运行结果如图15-42所示。</p> 
 <div class="center"> 
  <img alt="" class="u654" src="../Images/281_03.jpg" width="1280" height="568"/> 
  <p class="imgtitle">图15-42 百度语音转文字</p> 
 </div> 
 <h4 class="sigil_not_in_toc" id="Ab42c0119-6fd1-4e97-811c-6c90aff7e6b9">15.4.3 文字转语音——eSpeak</h4> 
 <p class="calibre3">实现文字转语音的功能，把输入的文字朗读出来，也就是通常所说的Text-To-Speech（TTS）。在树莓派上实现文字转语音服务有三种方法。</p> 
 <p class="calibre3">（1）方法1：Festival Text to Speech。</p> 
 <p class="calibre3">（2）方法2：eSpeak Text to Speech。</p> 
 <p class="calibre3">（3）方法3：Google Text to Speech。</p> 
 <p class="calibre3">这里选择eSpeak。eSpeak是一个英语的TTS引擎，同时它还支持其他语言。</p> 
 <p class="calibre3">安装eSpeak的命令如下：</p> 
 <div class="center">
  <img alt="" class="u655" src="../Images/282_01.jpg" width="1280" height="126"/>
 </div> 
 <p class="calibre3">但这样安装好之后，是无法直接使用的。输入下列命令：</p> 
 <div class="center">
  <img alt="" class="u656" src="../Images/282_02.jpg" width="1280" height="47"/>
 </div> 
 <p class="calibre3">这是让eSpeak朗读“hello”，通常情况下会直接报错，这是因为需要让系统在启动的时候加载和音频相关的模块，修改/boot/config.txt，因此要在里面添加上一句：</p> 
 <div class="center">
  <img alt="" class="u460" src="../Images/282_03.jpg" width="1280" height="45"/>
 </div> 
 <p class="calibre3">重启之后，再执行上面的eSpeak命令就可以听到声音了。如果要让eSpeak朗读中文，可以带参数这样执行：</p> 
 <div class="center">
  <img alt="" class="u657" src="../Images/282_04.jpg" width="1280" height="56"/>
 </div> 
 <h4 class="sigil_not_in_toc" id="A60720119-14fc-465f-91a1-6b62030e5542">15.4.4 实现聊天机器人</h4> 
 <p class="calibre3">下面是综合程序的代码，可以实现语音聊天。在树莓派打开Python2的IDLE窗口，新建文件，输入下列代码，并将文件保存为Chat_Robot.py：</p> 
 <div class="center">
  <img alt="" class="u658" src="../Images/282_05.jpg" width="1280" height="729"/>
 </div> 
 <div class="center">
  <img alt="" class="u659" src="../Images/283_01.jpg" width="1280" height="1852"/>
 </div> 
 <div class="center">
  <img alt="" class="u660" src="../Images/284_01.jpg" width="1280" height="490"/>
 </div> 
 <p class="calibre3">运行结果如图15-43所示。</p> 
 <div class="center"> 
  <img alt="" class="u661" src="../Images/284_02.jpg" width="1280" height="719"/> 
  <p class="imgtitle">图15-43 聊天机器人运行结果</p> 
 </div> 
 <h3 id="A9f4beeb6-1903-4dcd-902e-561236647227" class="calibre14">15.5 本章小结</h3> 
 <p class="calibre3">树莓派是一个基于Linux操作系统的计算机系统，由于Linux的开源性，使其包含了丰富的应用软件，语音处理是其中的重要内容之一。在人工智能快速发展的今天，人工智能也被快速地应用于机器人。本章介绍了基于树莓派的语音处理的相关内容，包含树莓派的主流播放器、树莓派使用的USB话筒、利用树莓派实现天气播报、利用树莓派实现聊天机器人等，并且每一部分都给出了应用示例及实现方法。</p> 
</body>
</html>
